<!DOCTYPE html>
<html lang="en" x-data="html2pdfLanding()" x-init="init()">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>html2pdf · HTML → PDF microservice</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <style>
    :root {
      /* Orange-forward, light theme (approx. fovebo.com). */
      --fv-primary: #ff6a2a;
      --fv-primary-dark: #c64514;
      --fv-accent: #ff8a4c;
      --fv-ink: #0f172a;
      --fv-bg: #fff7f2;
      --fv-card: #ffffff;
      --fv-border: rgba(15, 23, 42, 0.10);
    }

    html,
    body {
      height: 100%;
    }

    body {
      background: var(--fv-bg);
      color: var(--fv-ink);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    main {
      flex: 1 0 auto;
    }

    .navbar {
      background: var(--fv-primary) !important;
    }

    .navbar .nav-link,
    .navbar .navbar-brand {
      color: rgba(255, 255, 255, .94) !important;
    }

    .navbar .nav-link:hover {
      color: #fff !important;
    }

    .hero {
      background:
        radial-gradient(1200px 520px at 15% 25%, rgba(255, 138, 76, .35) 0%, rgba(255, 138, 76, 0) 60%),
        radial-gradient(900px 520px at 85% 10%, rgba(255, 106, 42, .55) 0%, rgba(255, 106, 42, 0) 58%),
        linear-gradient(180deg, var(--fv-primary) 0%, var(--fv-primary-dark) 100%);
      color: #fff;
    }

    .hero .lead {
      color: rgba(255, 255, 255, .90);
    }

    .pill {
      border: 1px solid rgba(255, 255, 255, .25);
      background: rgba(255, 255, 255, .10);
      color: #fff;
      padding: .45rem .75rem;
      border-radius: 999px;
      font-size: .9rem;
    }

    .section {
      padding: 5rem 0;
    }

    .section-tight {
      padding: 3.5rem 0;
    }

    .card {
      border: 1px solid var(--fv-border);
      border-radius: 1rem;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.06);
      background: var(--fv-card);
    }

    .card-header {
      background: rgba(255, 106, 42, .06);
      border-bottom: 1px solid var(--fv-border);
      border-top-left-radius: 1rem !important;
      border-top-right-radius: 1rem !important;
    }

    .btn-fv {
      background: var(--fv-primary);
      border-color: var(--fv-primary);
      color: #fff;
      font-weight: 700;
    }

    .btn-fv:hover {
      background: var(--fv-primary-dark);
      border-color: var(--fv-primary-dark);
      color: #fff;
    }

    .btn-fv-outline {
      border: 1px solid rgba(255, 255, 255, .60);
      color: #fff;
      font-weight: 700;
    }

    .btn-fv-outline:hover {
      background: #fff;
      color: var(--fv-primary-dark);
    }

    .feature-icon {
      width: 54px;
      height: 54px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 14px;
      background: rgba(255, 106, 42, .10);
      color: var(--fv-primary-dark);
      font-size: 26px;
      flex: 0 0 auto;
    }

    pre {
      background: #0b1220;
      color: #e5e7eb;
      padding: 1rem;
      border-radius: .9rem;
      border: 1px solid rgba(255, 255, 255, .08);
      overflow: auto;
      margin: 0;
    }

    code {
      font-size: .92rem;
    }

    .muted {
      color: rgba(15, 23, 42, .72);
    }

    .small-muted {
      color: rgba(15, 23, 42, .62);
      font-size: .92rem;
    }

    .result-frame {
      width: 100%;
      min-height: 520px;
      border: 1px solid var(--fv-border);
      border-radius: 1rem;
      background: #fff;
    }

    .copy-btn {
      position: absolute;
      top: .9rem;
      right: .9rem;
    }

    .anchor-offset {
      scroll-margin-top: 90px;
    }

    [x-cloak] {
      display: none !important;
    }

    footer {
      flex-shrink: 0;
      background: rgba(255, 106, 42, .08);
    }
  </style>
</head>

<body data-bs-spy="scroll" data-bs-target="#nav" data-bs-offset="90">
  <nav id="nav" class="navbar navbar-expand-lg navbar-dark fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#top">html2pdf</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navmenu">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">
          <li class="nav-item"><a class="nav-link" href="#features">Features</a></li>
          <li class="nav-item"><a class="nav-link" href="#demo">Demo</a></li>
          <li class="nav-item"><a class="nav-link" href="#quickstart">Quickstart</a></li>
          <li class="nav-item"><a class="nav-link" href="#api">API</a></li>
          <li class="nav-item"><a class="nav-link" href="https://github.com/aplgr/html2pdf-service" target="_blank"
               rel="noopener noreferrer" aria-label="GitHub repository" title="GitHub">
              <i class="bi bi-github fs-5"></i>
            </a></li>
        </ul>
      </div>
    </div>
  </nav>
  <main>
    <header id="top" class="hero section anchor-offset">
      <div class="container">
        <div class="row align-items-center g-4">
          <div class="col-lg-7">
            <div class="d-flex flex-wrap gap-2 mb-3">
              <span class="pill"><i class="bi bi-box-seam me-1"></i> Docker-first</span>
              <span class="pill"><i class="bi bi-diagram-3 me-1"></i> Envoy edge</span>
              <span class="pill"><i class="bi bi-lightning-charge me-1"></i> Fast</span>
              <span class="pill"><i class="bi bi-shield-lock me-1"></i> API key</span>
              <span class="pill"><i class="bi bi-arrow-repeat me-1"></i> Cache + Rate limit</span>
            </div>
            <h1 class="display-5 fw-semibold mb-3">Turn HTML into PDF, reliably.</h1>
            <p class="lead mb-4"> A small Go microservice that renders raw HTML or a URL to PDF via headless Chromium,
              fronted by Envoy and backed by PostgreSQL (tokens) + Redis (cache/limits). Ship it as a container and keep
              the server clean. </p>
            <div class="d-flex flex-wrap gap-2">
              <a href="#demo" class="btn btn-light btn-lg"><i class="bi bi-play-circle me-1"></i> Try the demo</a>
              <a href="#quickstart" class="btn btn-lg btn-fv-outline"><i class="bi bi-terminal me-1"></i> Quickstart</a>
            </div>
            <p class="mt-3 small" style="color: rgba(255,255,255,.82);"> Defaults: <strong>30s timeout</strong>, margins
              in <strong>inches</strong>, output served as <strong>application/pdf</strong>. </p>
          </div>
          <div class="col-lg-5">
            <div class="card p-3 p-md-4">
              <div class="d-flex align-items-start gap-3">
                <div class="feature-icon"><i class="bi bi-terminal"></i></div>
                <div class="flex-grow-1">
                  <div class="fw-semibold mb-1">Local smoke test</div>
                  <div class="small-muted mb-2">POST HTML → PDF</div>
                  <pre><code>curl -k -H "X-API-Key: &lt;your-api-key&gt;" \\
-X POST "https://localhost/api/v0/pdf" \\
--form-string 'html=&lt;h1&gt;Hello PDF&lt;/h1&gt;' \\
-F "format=A4" -F "orientation=portrait" -F "margin=0.4" \\
-o out.pdf
                    </code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <section id="features" class="section anchor-offset">
      <div class="container">
        <div class="row mb-4">
          <div class="col-lg-8">
            <h2 class="fw-semibold">What it does</h2>
            <p class="muted mb-0">A pragmatic HTML → PDF service: Envoy sits at the edge, the Go/Fiber app renders via
              headless Chromium, Redis holds short-lived cache + rate-limiter state, and PostgreSQL stores API tokens
              (with per-token limits).</p>
          </div>
        </div>
        <div class="row g-4">
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-file-earmark-pdf"></i></div>
                <div>
                  <div class="fw-semibold">HTML & URL input</div>
                  <div class="small-muted">Use <code>POST /api/v0/pdf</code> for raw HTML or
                    <code>GET /api/v0/pdf?url=…</code> for remote pages.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-lightning"></i></div>
                <div>
                  <div class="fw-semibold">Preloaded Chrome tabs</div>
                  <div class="small-muted">Optional Chrome pool keeps tabs warm. Faster throughput, less startup
                    overhead.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-arrow-repeat"></i></div>
                <div>
                  <div class="fw-semibold">Redis cache</div>
                  <div class="small-muted">Same HTML/URL + same parameters → served instantly from cache (if enabled).
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-shield-check"></i></div>
                <div>
                  <div class="fw-semibold">Rate limiting + tokens</div>
                  <div class="small-muted">Token policies live in PostgreSQL, rate limiting state in Redis. Envoy
                    handles edge routing so the app stays focused on rendering.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-journal-text"></i></div>
                <div>
                  <div class="fw-semibold">File logging</div>
                  <div class="small-muted">Rotating logs via <code>lumberjack</code>. In Docker Compose,
                    <code>./logs</code> is mounted by default.</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
              <div class="d-flex gap-3">
                <div class="feature-icon"><i class="bi bi-sliders"></i></div>
                <div>
                  <div class="fw-semibold">Simple knobs</div>
                  <div class="small-muted">Paper size, orientation, margin, filename. That’s it. The service stays
                    boring.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="demo" class="section-tight anchor-offset">
      <div class="container">
        <div class="row mb-4">
          <div class="col-lg-8">
            <h2 class="fw-semibold">Demo</h2>
            <p class="muted mb-0"> This page calls the API via Alpine.js (through Envoy). The public demo runs with a
              shared key and a conservative rate limit, so you can try it without signing up. (When self-hosting, you’ll
              use your own API key and token limits from PostgreSQL.) </p>
          </div>
        </div>
        <div class="row g-4">
          <div class="col-lg-5">
            <div class="card">
              <div class="card-header p-3">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                  <div class="fw-semibold">Generate a PDF</div>
                  <div class="btn-group" role="group" aria-label="input mode">
                    <button type="button" class="btn btn-sm" :class="mode==='get' ? 'btn-fv' : 'btn-outline-secondary'"
                            @click="setMode('get')">
                      <i class="bi bi-link-45deg me-1"></i> URL (GET) </button>
                    <button type="button" class="btn btn-sm" :class="mode==='post' ? 'btn-fv' : 'btn-outline-secondary'"
                            @click="setMode('post')">
                      <i class="bi bi-code-slash me-1"></i> HTML (POST) </button>
                  </div>
                </div>
              </div>
              <div class="p-3 p-md-4">
                <!-- URL mode -->
                <div class="mb-3" x-show="mode==='get'" x-cloak>
                  <label class="form-label fw-semibold">External URL</label>
                  <input class="form-control" type="url" placeholder="https://example.com" x-model.trim="url"
                         value="https://example.com" />
                  <div class="form-text">Used as <code>GET /api/v0/pdf?url=…</code></div>
                </div>
                <!-- HTML mode -->
                <div class="mb-3" x-show="mode==='post'" x-cloak>
                  <div class="d-flex align-items-center justify-content-between gap-2">
                    <label class="form-label fw-semibold mb-0">HTML</label>
                    <div class="d-flex gap-2 align-items-center">
                      <select class="form-select form-select-sm" style="max-width: 280px;" x-model="selectedExampleId"
                              @change="loadSelectedExample()" :disabled="exampleLoading">
                        <option value="">Load example…</option>
                        <template x-for="ex in examples" :key="ex.id">
                          <option :value="ex.id" x-text="ex.title"></option>
                        </template>
                      </select>
                      <button class="btn btn-sm btn-outline-secondary" type="button" title="Reload examples"
                              @click="fetchExamples" :disabled="exampleLoading">
                        <i class="bi bi-arrow-clockwise"></i>
                      </button>
                    </div>
                  </div>
                  <textarea class="form-control font-monospace" rows="11" x-model="html"></textarea>
                  <div class="form-text"> Used as <code>POST /api/v0/pdf</code> with multipart form-data. <span
                          class="ms-1" x-show="selectedExample" x-cloak> Loaded: <code
                            x-text="selectedExample && selectedExample.path"></code>
                    </span>
                  </div>
                  <div class="form-text text-danger" x-show="examplesError" x-text="examplesError" x-cloak></div>
                </div>
                <div class="row g-3">
                  <div class="col-sm-6">
                    <label class="form-label fw-semibold">Format</label>
                    <select class="form-select" x-model="format">
                      <option value="">(server default)</option>
                      <option value="A4" selected>A4</option>
                      <option value="LETTER">LETTER</option>
                      <option value="LEGAL">LEGAL</option>
                      <option value="A5">A5</option>
                      <option value="A3">A3</option>
                      <option value="TABLOID">TABLOID</option>
                    </select>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label fw-semibold">Orientation</label>
                    <select class="form-select" x-model="orientation">
                      <option value="portrait">portrait (default)</option>
                      <option value="landscape">landscape</option>
                    </select>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label fw-semibold">Margin (inches)</label>
                    <input class="form-control" type="number" step="0.1" min="0.1" max="2.0" x-model.number="margin"
                           value="0.4" />
                    <div class="form-text">Valid range: 0.1 … 2.0</div>
                  </div>
                  <div class="col-sm-6">
                    <label class="form-label fw-semibold">Filename</label>
                    <input class="form-control" type="text" placeholder="output.pdf" x-model.trim="filename"
                           value="output.pdf" />
                    <div class="form-text">Must end with <code>.pdf</code></div>
                  </div>
                </div>
                <div class="d-flex flex-wrap gap-2 mt-4">
                  <button class="btn btn-fv btn-lg" type="button" @click="generate" :disabled="busy">
                    <span><i class="bi bi-magic me-1"></i> Generate PDF</span>
                    <span class="ms-2" x-show="busy" style="display:none">
                      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                      <span class="ms-1">Rendering…</span>
                    </span>
                  </button>
                  <button class="btn btn-outline-secondary btn-lg" type="button" @click="clearResult" :disabled="busy">
                    <i class="bi bi-x-circle me-1"></i> Clear </button>
                </div>
                <div class="mt-4 position-relative">
                  <button class="btn btn-sm btn-outline-secondary copy-btn" type="button" @click="copy(curlSnippet)">
                    <i class="bi bi-clipboard"></i>
                  </button>
                  <div class="small-muted mb-2">Example curl (uses a placeholder key; the demo key is not shown here)
                  </div>
                  <pre><code x-text="curlSnippet"></code></pre>
                </div>
                <template x-if="result.error">
                  <div class="alert alert-danger mt-4 mb-0">
                    <div class="fw-semibold">Error</div>
                    <div x-text="result.error"></div>
                    <template x-if="result.debug">
                      <details class="mt-2">
                        <summary>Debug</summary>
                        <pre class="mt-2"><code x-text="result.debug"></code></pre>
                      </details>
                    </template>
                  </div>
                </template>
              </div>
            </div>
          </div>
          <div class="col-lg-7">
            <div class="card">
              <div class="card-header p-3 d-flex justify-content-between align-items-center flex-wrap gap-2">
                <div class="fw-semibold">Result</div>
                <div class="d-flex gap-2">
                  <a class="btn btn-sm btn-outline-secondary" :class="!result.ok ? 'disabled' : ''"
                     :href="result.blobUrl" :download="result.filename">
                    <i class="bi bi-download me-1"></i> Download </a>
                  <button class="btn btn-sm btn-outline-secondary" type="button" @click="openInNewTab"
                          :disabled="!result.ok">
                    <i class="bi bi-box-arrow-up-right me-1"></i> Open </button>
                </div>
              </div>
              <div class="p-3 p-md-4">
                <template x-if="!result.ok">
                  <div class="small-muted"> Generate a PDF and it will show up here. If you use URL mode, make sure the
                    URL is reachable from the server. </div>
                </template>
                <template x-if="result.ok">
                  <div>
                    <div class="d-flex flex-wrap gap-2 mb-3">
                      <span class="badge text-bg-light border">File: <span class="fw-semibold"
                              x-text="result.filename"></span></span>
                      <span class="badge text-bg-light border">Size: <span class="fw-semibold"
                              x-text="result.meta"></span></span>
                    </div>
                    <iframe class="result-frame" :src="result.blobUrl"></iframe>
                  </div>
                </template>
              </div>
            </div>
            <div class="card mt-4">
              <div class="card-header p-3">
                <div class="fw-semibold">Notes</div>
              </div>
              <div class="p-3 p-md-4 small-muted">
                <ul class="mb-0">
                  <li><strong>Margins</strong> are inches (matches Chromium’s PDF print API).</li>
                  <li><strong>Timeout</strong> is enforced server-side (default: 30s).</li>
                  <li><strong>Cache</strong> uses a hash of HTML/URL + format + orientation + margin.</li>
                  <li><strong>Chrome pool</strong> speeds things up, but needs enough resources for concurrent renders.
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="quickstart" class="section-tight anchor-offset">
      <div class="container">
        <div class="row mb-4">
          <div class="col-lg-8">
            <h2 class="fw-semibold">Quickstart (self-host)</h2>
            <p class="muted mb-0">Clone, run, tail logs. No extra server setup required beyond Docker + Compose.</p>
          </div>
        </div>
        <div class="row g-4">
          <div class="col-lg-4">
            <div class="card h-100">
              <div class="card-header p-3">
                <div class="fw-semibold">1) Clone</div>
              </div>
              <div class="p-3 p-md-4">
                <pre><code>git clone git@github.com:aplgr/html2pdf-service.git
cd html2pdf-service</code></pre>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card h-100">
              <div class="card-header p-3">
                <div class="fw-semibold">2) Run</div>
              </div>
              <div class="p-3 p-md-4">
                <pre><code>docker compose up --build</code></pre>
                <div class="small-muted mt-2">Logs are mounted to <code>./logs</code> by default.</div>
                <pre class="mt-2"><code>tail -f ./logs/html2pdf.log</code></pre>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card h-100">
              <div class="card-header p-3">
                <div class="fw-semibold">3) Use</div>
              </div>
              <div class="p-3 p-md-4">
                <div class="small-muted mb-2">GET (URL → PDF)</div>
                <pre><code>curl -k -H "X-API-Key: &lt;your-api-key&gt;" \\
  -X GET "https://localhost/api/v0/pdf?url=https://example.com&amp;format=A4&amp;orientation=portrait&amp;margin=0.4" \\
  -o page.pdf</code></pre>
                <div class="small-muted mt-3 mb-2">POST (HTML → PDF)</div>
                <pre><code>curl -k -H "X-API-Key: &lt;your-api-key&gt;" \\
  -X POST https://localhost/api/v0/pdf \\
  --form-string "html=&lt;h1&gt;Hello&lt;/h1&gt;" \\
  -F "format=A4" -F "orientation=portrait" -F "margin=0.4" \\
  -o page.pdf</code></pre>
              </div>
            </div>
          </div>
        </div>
        <div class="row mt-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header p-3">
                <div class="fw-semibold">Docker Compose notes</div>
              </div>
              <div class="p-3 p-md-4 small-muted">
                <ul class="mb-0">
                  <li><strong>Envoy</strong> is the public entrypoint in the compose stack and forwards
                    <code>/api</code> to the Go app.</li>
                  <li><strong>Redis</strong> is internal to the compose network (cache + rate limiter state).</li>
                  <li><strong>PostgreSQL</strong> runs as a dedicated container and stores API tokens (and per-token
                    limits).</li>
                  <li><strong>Chrome pool</strong> can be tuned via <code>pdf.chrome_pool_size</code> in
                    <code>config.docker.yaml</code>.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="api" class="section anchor-offset">
      <div class="container">
        <div class="row mb-4">
          <div class="col-lg-8">
            <h2 class="fw-semibold">API reference</h2>
            <p class="muted mb-0">Endpoints and parameters for PDF generation. In the public demo you can try requests
              without a key (limited per IP+User-Agent). When you provide <code>X-API-Key</code>, per-token limits apply
              (tokens are stored in PostgreSQL).</p>
          </div>
        </div>
        <div class="row g-4">
          <div class="col-lg-6">
            <div class="card h-100">
              <div class="card-header p-3">
                <div class="fw-semibold"><code>POST /api/v0/pdf</code></div>
              </div>
              <div class="p-3 p-md-4">
                <p class="small-muted mb-2">Multipart form-data:</p>
                <div class="table-responsive">
                  <table class="table table-sm align-middle mb-0">
                    <thead>
                      <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>html</code></td>
                        <td>string</td>
                        <td>yes</td>
                        <td>Raw HTML. Must be at least 10 chars.</td>
                      </tr>
                      <tr>
                        <td><code>format</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td>One of the supported paper sizes (see config).</td>
                      </tr>
                      <tr>
                        <td><code>orientation</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td><code>portrait</code> (default) or <code>landscape</code></td>
                      </tr>
                      <tr>
                        <td><code>margin</code></td>
                        <td>float</td>
                        <td>no</td>
                        <td>Inches. Range: 0.1 … 2.0 (default: 0.4)</td>
                      </tr>
                      <tr>
                        <td><code>filename</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td>Must end with <code>.pdf</code>; limited charset</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <hr>
                <pre><code>curl -k -H "X-API-Key: &lt;your-api-key&gt;" \\
  -X POST https://localhost/api/v0/pdf \\
  -F "html=@./invoice.html" \\
  -F "format=A4" -F "orientation=portrait" -F "margin=0.4" \\
  -o invoice.pdf</code></pre>
              </div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="card h-100">
              <div class="card-header p-3">
                <div class="fw-semibold"><code>GET /api/v0/pdf?url=…</code></div>
              </div>
              <div class="p-3 p-md-4">
                <p class="small-muted mb-2">Query parameters:</p>
                <div class="table-responsive">
                  <table class="table table-sm align-middle mb-0">
                    <thead>
                      <tr>
                        <th>Param</th>
                        <th>Type</th>
                        <th>Required</th>
                        <th>Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>url</code></td>
                        <td>string</td>
                        <td>yes</td>
                        <td>Must be http(s). Rendered in Chromium.</td>
                      </tr>
                      <tr>
                        <td><code>format</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td>One of the supported paper sizes (see config).</td>
                      </tr>
                      <tr>
                        <td><code>orientation</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td><code>portrait</code> (default) or <code>landscape</code></td>
                      </tr>
                      <tr>
                        <td><code>margin</code></td>
                        <td>float</td>
                        <td>no</td>
                        <td>Inches. Range: 0.1 … 2.0 (default: 0.4)</td>
                      </tr>
                      <tr>
                        <td><code>filename</code></td>
                        <td>string</td>
                        <td>no</td>
                        <td>Must end with <code>.pdf</code>; limited charset</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <hr>
                <pre><code>curl -k -H "X-API-Key: &lt;your-api-key&gt;"\\
  -X GET "https://localhost/api/v0/pdf?url=https://example.com&amp;format=A4&amp;orientation=portrait&amp;margin=0.4" \\
  -o page.pdf</code></pre>
              </div>
            </div>
          </div>
        </div>
        <div class="row mt-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header p-3">
                <div class="fw-semibold">Responses</div>
              </div>
              <div class="p-3 p-md-4 small-muted">
                <ul class="mb-0">
                  <li><code>200</code> → PDF bytes with <code>Content-Type: application/pdf</code></li>
                  <li><code>400</code> → validation errors (missing/invalid html/url, bad format, etc.)</li>
                  <li><code>408</code> → render exceeded timeout</li>
                  <li><code>413</code> → HTML/PDF exceeds configured size limits</li>
                  <li><code>429</code> → rate limit exceeded</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer class="py-4">
    <div class="container d-flex flex-wrap justify-content-between align-items-center gap-2">
      <div class="small-muted">© 2025 · <a href="https://github.com/aplgr/html2pdf-service" target="_blank"
           rel="noopener noreferrer" style="color: inherit; text-decoration: none;">André Plöger</a> · MIT license</div>
      <div class="small-muted">Envoy · Go · Fiber · Chromium · PostgreSQL · Redis · Docker Compose</div>
    </div>
  </footer>
  <script>
    function html2pdfLanding() {
      return {
        mode: 'post',

        // Examples (served from /examples via nginx)
        examples: [],
        selectedExampleId: '',
        examplesError: '',
        exampleLoading: false,

        // POST
        html: `<!doctype html>
<html>
  <head><meta charset="utf-8"><title>Hello</title></head>
  <body style="font-family: Arial, sans-serif; padding: 24px;">
    <h1>Hello PDF</h1>
    <p>This PDF was generated by <strong>html2pdf</strong>.</p>
</body>
</html>`,
        // GET
        url: 'https://example.com',

        // shared params
        format: 'A4',
        orientation: 'portrait',
        margin: 0.4,
        filename: 'output.pdf',

        busy: false,
        aborter: null,

        result: { ok: false, blobUrl: '', filename: '', meta: '', error: '', debug: '' },

        init() {
          // no user-editable base URL: this page calls the same origin.
          this.fetchExamples();
        },

        get selectedExample() {
          return this.examples.find(e => e.id === this.selectedExampleId) || null;
        },

        async fetchExamples() {
          this.examplesError = '';
          this.exampleLoading = true;
          try {
            const res = await fetch('/examples/index.json', { cache: 'no-store' });
            if (!res.ok) throw new Error(`Failed to load examples index: HTTP ${res.status}`);
            const list = await res.json();
            if (!Array.isArray(list)) throw new Error('Invalid examples index (expected JSON array)');

            // Keep stable ordering (title, then id)
            this.examples = list
              .filter(x => x && typeof x === 'object' && x.id && x.title && x.path)
              .sort((a, b) => String(a.title).localeCompare(String(b.title)) || String(a.id).localeCompare(String(b.id)));
          } catch (e) {
            this.examples = [];
            this.examplesError = String(e && e.message ? e.message : e);
          } finally {
            this.exampleLoading = false;
          }
        },

        applyExampleDefaults(ex) {
          const d = ex && ex.defaultOptions ? ex.defaultOptions : null;
          if (!d) return;
          if (d.format) this.format = String(d.format);
          if (d.orientation) this.orientation = String(d.orientation);
          if (d.margin != null && d.margin !== '') {
            const n = Number(d.margin);
            if (!Number.isNaN(n)) this.margin = n;
          }
          if (d.filename) this.filename = String(d.filename);
        },

        async loadSelectedExample() {
          const ex = this.selectedExample;
          if (!ex) return;

          this.setMode('post');
          this.examplesError = '';
          this.exampleLoading = true;

          try {
            const res = await fetch(ex.path, { cache: 'no-store' });
            if (!res.ok) throw new Error(`Failed to load example: HTTP ${res.status}`);
            this.html = await res.text();
            this.applyExampleDefaults(ex);
          } catch (e) {
            this.examplesError = String(e && e.message ? e.message : e);
          } finally {
            this.exampleLoading = false;
          }
        },

        setMode(m) {
          this.mode = m;
          this.clearResult();
        },

        clearResult() {
          if (this.result.blobUrl) {
            try { URL.revokeObjectURL(this.result.blobUrl); } catch (_) { }
          }
          this.result = { ok: false, blobUrl: '', filename: '', meta: '', error: '', debug: '' };
        },

        get curlSnippet() {
          const base = '/api';
          const key = '<your-api-key>';
          const fmt = this.format ? `format=${encodeURIComponent(this.format)}` : '';
          const ori = this.orientation ? `orientation=${encodeURIComponent(this.orientation)}` : '';
          const mar = (this.margin != null && this.margin !== '') ? `margin=${encodeURIComponent(String(this.margin))}` : '';
          const fn = this.filename ? `filename=${encodeURIComponent(this.filename)}` : '';

          if (this.mode === 'get') {
            const u = this.url || 'https://example.com';
            const q = [
              `url=${encodeURIComponent(u)}`,
              fmt, ori, mar, fn
            ].filter(Boolean).join('&');
            return `curl -k -H "X-API-Key: ${key}" \\\\\n -X GET "${base}/v0/pdf?${q}" \\\\\n -o ${this.filename || 'out.pdf'}`;
          }

          return `curl -k -H "X-API-Key: ${key}" \\\\\n -X POST ${base}/v0/pdf \\\\\n  --form-string "html=<your html>" \\\\\n  ${this.format ? `-F "format=${this.format}" \\\\\n  ` : ''}${this.orientation ? `-F "orientation=${this.orientation}" \\\\\n  ` : ''}${(this.margin != null && this.margin !== '') ? `-F "margin=${String(this.margin)}" \\\\\n  ` : ''}${this.filename ? `-F "filename=${this.filename}" \\\\\n  ` : ''}-o ${this.filename || 'out.pdf'}`;
        },

        async copy(text) {
          try {
            await navigator.clipboard.writeText(String(text || ''));
          } catch (e) {
            const ta = document.createElement('textarea');
            ta.value = String(text || '');
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            ta.remove();
          }
        },

        openInNewTab() {
          if (!this.result.blobUrl) return;
          window.open(this.result.blobUrl, '_blank', 'noopener,noreferrer');
        },

        // Examples are now loaded dynamically from /examples/index.json.

        async generate() {
          this.clearResult();
          this.busy = true;

          const endpoint = '/api/v0/pdf';
          const controller = new AbortController();
          this.aborter = controller;

          try {
            const headers = {
              //'X-API-Key': 'DEMO_API_KEY'
            };

            let res;
            if (this.mode === 'post') {
              const form = new FormData();
              form.append('html', this.html || '');
              if (this.format) form.append('format', this.format);
              if (this.orientation) form.append('orientation', this.orientation);
              if (this.margin != null && this.margin !== '') form.append('margin', String(this.margin));
              if (this.filename) form.append('filename', this.filename);

              res = await fetch(endpoint, { method: 'POST', headers, body: form, signal: controller.signal });
            } else {
              const q = new URLSearchParams();
              q.set('url', this.url || '');
              if (this.format) q.set('format', this.format);
              if (this.orientation) q.set('orientation', this.orientation);
              if (this.margin != null && this.margin !== '') q.set('margin', String(this.margin));
              if (this.filename) q.set('filename', this.filename);

              res = await fetch(`${endpoint}?${q.toString()}`, { method: 'GET', headers, signal: controller.signal });
            }

            if (!res.ok) {
              const ct = res.headers.get('content-type') || '';
              let msg = `${res.status} ${res.statusText}`;
              let debug = '';

              try {
                if (ct.includes('application/json')) {
                  const j = await res.json();
                  if (j?.error?.message) msg = j.error.message;
                  debug = JSON.stringify(j, null, 2);
                } else {
                  const t = await res.text();
                  debug = t;
                }
              } catch (e) {
                // ignore parse errors
              }

              this.result.error = msg;
              this.result.debug = debug;
              return;
            }

            const blob = await res.blob();
            const blobUrl = URL.createObjectURL(blob);

            const disp = res.headers.get('content-disposition') || '';
            const fromHeader = this._filenameFromContentDisposition(disp);
            const outName = fromHeader || this.filename || 'output.pdf';

            this.result.ok = true;
            this.result.blobUrl = blobUrl;
            this.result.filename = outName;
            this.result.meta = `${Math.round(blob.size / 1024)} KB`;

          } catch (e) {
            this.result.error = (e && e.name === 'AbortError') ? 'Request aborted' : `Network / fetch error: ${String(e)}`;
          } finally {
            this.busy = false;
            this.aborter = null;
          }
        },

        _filenameFromContentDisposition(cd) {
          const m = /filename=([^;]+)/i.exec(cd || '');
          if (!m) return '';
          return m[1].trim().replace(/^"|"$/g, '');
        },
      };
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>